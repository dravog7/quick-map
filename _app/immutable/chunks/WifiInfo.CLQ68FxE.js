import{w as i,d as m}from"./index.B53n5CBn.js";import{a as d}from"./MapViewState.CUH0SxWd.js";import{z as c}from"./scheduler.PjKGdjWE.js";const r="https://proximityserverapi20240813112240.azurewebsites.net",f=`${r}/signals`,S=`${r}/signals/predict`,I=`${r}/wifi`;let s=i({deviceTypes:[0,1,2],deviceId:"",timeStart:Number(new Date().getTime())-1*60*60*1e3,timeEnd:Number(new Date().getTime())}),T=i("");const o=i([]),n={subscribe:o.subscribe,requestData:async()=>{let e=await v();o.update(()=>e)}};async function v(){let e=c(s),a=c(d);const t={from:e.timeStart,to:e.timeEnd,type:e.deviceTypes.length==1?e.deviceTypes[0]:void 0,zone:a.toFixed(0)},l=new URLSearchParams(Object.fromEntries(Object.entries(t).filter(([b,u])=>u!==void 0))).toString(),p=await fetch(f+"?"+l,{headers:{Accept:"application/json"}});return console.log("collected data!"),await p.json()}let h=m([s,n],([e,a])=>a.filter(t=>e.deviceTypes.includes(t.deviceType)).filter(t=>e.deviceId!=""?t.deviceId.startsWith(e.deviceId):!0));s.subscribe(async e=>{await n.requestData()});d.subscribe(async e=>{await n.requestData()});export{s as a,T as b,h as f,I as l,S as p};
